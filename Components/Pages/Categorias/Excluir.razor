@page "/Categorias/Excluir/{id:int}"
@using Big.Models
@using Big.Services
@inject CategoriaService CategoriaService
@inject NavigationManager Navigation
@rendermode InteractiveServer

<h3>Excluir Categoria</h3>

@if (categoria == null)
{
    <p>Carregando informações da categoria...</p>
}
else
{
    <div class="alert alert-danger">
        <h5>Você tem certeza que deseja excluir a categoria abaixo?</h5>
        <p><strong>Nome:</strong> @categoria.Nome</p>

        <div class="mt-3">
            <button class="btn btn-danger" @onclick="ConfirmarExclusao">Excluir</button>
            <a href="/Categorias" class="btn btn-secondary">Cancelar</a>
        </div>
    </div>
}

@code {
    [Parameter]
    public int Id { get; set; }

    private Categoria? categoria;

    protected override async Task OnInitializedAsync()
    {
        categoria = await CategoriaService.ObterPorIdAsync(Id);

        if (categoria == null)
        {
            Navigation.NavigateTo("/Categorias");
        }
    }

    private async Task ConfirmarExclusao()
    {
        try
        {
            await CategoriaService.ExcluirAsync(Id);
            Navigation.NavigateTo("/Categorias");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Erro ao excluir a categoria: {ex.Message}");
        }
    }
}